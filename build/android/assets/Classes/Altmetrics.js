module.exports = function (opts) {
  const view = opts.view;
  const type = opts.type;
  const doi = opts.doi;
  const onclick = opts.onclick;
  const endpoint = "https://api.altmetric.com/v1/";
  const xhr = Ti.Network.createHTTPClient({
    onload: function (e) {
      const image = JSON.parse(this.responseText).images.large;
      const link = JSON.parse(this.responseText).details_url;
      const subxhr = Ti.Network.createHTTPClient({
        onload: function () {
          view.link = link;
          view.image = this.responseData;
        } });

      subxhr.open("GET", image);
      subxhr.send();
      view.addEventListener('click', function () {
        require('Views/altmetrics.window')(link);
      });
    },

    timeout: 5000 });

  const url = endpoint + type + '/' + doi;

  xhr.open("GET", url);
  xhr.setRequestHeader("Accept", "application/json");
  xhr.send();

};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkFsdG1ldHJpY3MuanMiXSwibmFtZXMiOlsibW9kdWxlIiwiZXhwb3J0cyIsIm9wdHMiLCJ2aWV3IiwidHlwZSIsImRvaSIsIm9uY2xpY2siLCJlbmRwb2ludCIsInhociIsIlRpIiwiTmV0d29yayIsImNyZWF0ZUhUVFBDbGllbnQiLCJvbmxvYWQiLCJlIiwiaW1hZ2UiLCJKU09OIiwicGFyc2UiLCJyZXNwb25zZVRleHQiLCJpbWFnZXMiLCJsYXJnZSIsImxpbmsiLCJkZXRhaWxzX3VybCIsInN1YnhociIsInJlc3BvbnNlRGF0YSIsIm9wZW4iLCJzZW5kIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlcXVpcmUiLCJ0aW1lb3V0IiwidXJsIiwic2V0UmVxdWVzdEhlYWRlciJdLCJtYXBwaW5ncyI6IkFBQUFBLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQixVQUFTQyxJQUFULEVBQWU7QUFDL0IsUUFBTUMsSUFBSSxHQUFHRCxJQUFJLENBQUNDLElBQWxCO0FBQ0EsUUFBTUMsSUFBSSxHQUFHRixJQUFJLENBQUNFLElBQWxCO0FBQ0EsUUFBTUMsR0FBRyxHQUFHSCxJQUFJLENBQUNHLEdBQWpCO0FBQ0EsUUFBTUMsT0FBTyxHQUFHSixJQUFJLENBQUNJLE9BQXJCO0FBQ0EsUUFBTUMsUUFBUSxHQUFHLCtCQUFqQjtBQUNBLFFBQU1DLEdBQUcsR0FBR0MsRUFBRSxDQUFDQyxPQUFILENBQVdDLGdCQUFYLENBQTRCO0FBQ3ZDQyxJQUFBQSxNQUFNLEVBQUcsVUFBU0MsQ0FBVCxFQUFZO0FBQ3BCLFlBQU1DLEtBQUssR0FBR0MsSUFBSSxDQUFDQyxLQUFMLENBQVcsS0FBS0MsWUFBaEIsRUFBOEJDLE1BQTlCLENBQXFDQyxLQUFuRDtBQUNBLFlBQU1DLElBQUksR0FBR0wsSUFBSSxDQUFDQyxLQUFMLENBQVcsS0FBS0MsWUFBaEIsRUFBOEJJLFdBQTNDO0FBQ0EsWUFBTUMsTUFBTSxHQUFHYixFQUFFLENBQUNDLE9BQUgsQ0FBV0MsZ0JBQVgsQ0FBNEI7QUFDMUNDLFFBQUFBLE1BQU0sRUFBRyxZQUFXO0FBQ25CVCxVQUFBQSxJQUFJLENBQUNpQixJQUFMLEdBQVlBLElBQVo7QUFDQWpCLFVBQUFBLElBQUksQ0FBQ1csS0FBTCxHQUFhLEtBQUtTLFlBQWxCO0FBQ0EsU0FKeUMsRUFBNUIsQ0FBZjs7QUFNQUQsTUFBQUEsTUFBTSxDQUFDRSxJQUFQLENBQVksS0FBWixFQUFtQlYsS0FBbkI7QUFDQVEsTUFBQUEsTUFBTSxDQUFDRyxJQUFQO0FBQ0F0QixNQUFBQSxJQUFJLENBQUN1QixnQkFBTCxDQUFzQixPQUF0QixFQUErQixZQUFXO0FBQ3pDQyxRQUFBQSxPQUFPLENBQUMseUJBQUQsQ0FBUCxDQUFtQ1AsSUFBbkM7QUFDQSxPQUZEO0FBR0EsS0Fmc0M7O0FBaUJ2Q1EsSUFBQUEsT0FBTyxFQUFHLElBakI2QixFQUE1QixDQUFaOztBQW1CQSxRQUFNQyxHQUFHLEdBQUd0QixRQUFRLEdBQUdILElBQVgsR0FBa0IsR0FBbEIsR0FBd0JDLEdBQXBDOztBQUVBRyxFQUFBQSxHQUFHLENBQUNnQixJQUFKLENBQVMsS0FBVCxFQUFnQkssR0FBaEI7QUFDQXJCLEVBQUFBLEdBQUcsQ0FBQ3NCLGdCQUFKLENBQXFCLFFBQXJCLEVBQStCLGtCQUEvQjtBQUNBdEIsRUFBQUEsR0FBRyxDQUFDaUIsSUFBSjs7QUFFQSxDQS9CRCIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob3B0cykge1xuXHRjb25zdCB2aWV3ID0gb3B0cy52aWV3O1xuXHRjb25zdCB0eXBlID0gb3B0cy50eXBlO1xuXHRjb25zdCBkb2kgPSBvcHRzLmRvaTtcblx0Y29uc3Qgb25jbGljayA9IG9wdHMub25jbGljaztcblx0Y29uc3QgZW5kcG9pbnQgPSBcImh0dHBzOi8vYXBpLmFsdG1ldHJpYy5jb20vdjEvXCI7XG5cdGNvbnN0IHhociA9IFRpLk5ldHdvcmsuY3JlYXRlSFRUUENsaWVudCh7XG5cdFx0b25sb2FkIDogZnVuY3Rpb24oZSkge1xuXHRcdFx0Y29uc3QgaW1hZ2UgPSBKU09OLnBhcnNlKHRoaXMucmVzcG9uc2VUZXh0KS5pbWFnZXMubGFyZ2U7XG5cdFx0XHRjb25zdCBsaW5rID0gSlNPTi5wYXJzZSh0aGlzLnJlc3BvbnNlVGV4dCkuZGV0YWlsc191cmw7XG5cdFx0XHRjb25zdCBzdWJ4aHIgPSBUaS5OZXR3b3JrLmNyZWF0ZUhUVFBDbGllbnQoe1xuXHRcdFx0XHRvbmxvYWQgOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR2aWV3LmxpbmsgPSBsaW5rO1xuXHRcdFx0XHRcdHZpZXcuaW1hZ2UgPSB0aGlzLnJlc3BvbnNlRGF0YTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRzdWJ4aHIub3BlbihcIkdFVFwiLCBpbWFnZSk7XG5cdFx0XHRzdWJ4aHIuc2VuZCgpO1xuXHRcdFx0dmlldy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXF1aXJlKCdWaWV3cy9hbHRtZXRyaWNzLndpbmRvdycpKGxpbmspO1xuXHRcdFx0fSk7XG5cdFx0fSxcblxuXHRcdHRpbWVvdXQgOiA1MDAwLFxuXHR9KTtcblx0Y29uc3QgdXJsID0gZW5kcG9pbnQgKyB0eXBlICsgJy8nICsgZG9pO1xuXG5cdHhoci5vcGVuKFwiR0VUXCIsIHVybCk7XG5cdHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiQWNjZXB0XCIsIFwiYXBwbGljYXRpb24vanNvblwiKTtcblx0eGhyLnNlbmQoKTtcblxufTtcblxuIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvZnVlcnN0L0RvY3VtZW50cy9NTGVhcm5pbmcvU2NoYXVmZW5zdGVyL1Jlc291cmNlcy9DbGFzc2VzIn0=
